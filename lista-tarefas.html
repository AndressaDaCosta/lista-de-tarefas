<!DOCTYPE html>
<html lang="pt-BR">
	<head>
		<meta charset="UTF-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1.0" />
		<title>Semana 5 - Exercício 03 - Lista de Tarefas</title>
		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
				background-color: #f8f9fa;
				padding: 50px;
			}

			.container {
				max-width: 600px;
				margin: 0 auto;
				background: white;
				border-radius: 10px;
				padding: 40px;
				box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
			}

			h1 {
				color: #333;
				margin-bottom: 30px;
				text-align: center;
			}

			h2 {
				color: #333;
				margin: 40px 0 20px 0;
				text-align: center;
				font-size: 1.5em;
				border-top: 2px solid #dee2e6;
				padding-top: 30px;
			}

			.input-container {
				display: flex;
				gap: 10px;
				margin-bottom: 30px;
			}

			label {
				display: block;
				margin-bottom: 8px;
				font-weight: 600;
				color: #333;
			}

			input[type='text'] {
				flex: 1;
				padding: 12px;
				border: 2px solid #dee2e6;
				border-radius: 8px;
				font-size: 16px;
				transition: border-color 0.3s ease;
			}

			input[type='text']:focus {
				outline: none;
				border-color: #007bff;
			}

			.btn {
				padding: 12px 24px;
				background-color: #007bff;
				color: white;
				border: none;
				border-radius: 8px;
				font-size: 16px;
				font-weight: 600;
				cursor: pointer;
				transition: background-color 0.3s ease;
			}

			.btn:hover {
				background-color: #0056b3;
			}

			.lista-tarefas {
				list-style: none;
				padding: 0;
			}

			.tarefa-item {
				background-color: #f8f9fa;
				border: 1px solid #dee2e6;
				border-radius: 8px;
				padding: 15px;
				margin-bottom: 10px;
				display: flex;
				justify-content: space-between;
				align-items: center;
				transition: background-color 0.3s ease;
			}

			.tarefa-item:hover {
				background-color: #e9ecef;
			}

			.tarefa-texto {
				flex: 1;
				font-size: 16px;
				color: #333;
			}

			.tarefa-concluida {
				text-decoration: line-through;
				color: #6c757d;
			}

			.checkbox-container {
				display: flex;
				align-items: center;
				gap: 10px;
			}

			input[type='checkbox'] {
				width: 18px;
				height: 18px;
				cursor: pointer;
			}

			.btn-remover {
				background-color: #dc3545;
				color: white;
				border: none;
				border-radius: 5px;
				padding: 8px 12px;
				font-size: 12px;
				cursor: pointer;
				transition: background-color 0.3s ease;
			}

			.btn-remover:hover {
				background-color: #c82333;
			}

			.lista-vazia {
				text-align: center;
				color: #6c757d;
				font-style: italic;
				padding: 40px 20px;
				background-color: #f8f9fa;
				border-radius: 8px;
				border: 2px dashed #dee2e6;
			}

			.contador-tarefas {
				text-align: center;
				margin-bottom: 20px;
				color: #6c757d;
			}

			@media (max-width: 480px) {
				.input-container {
					flex-direction: column;
				}
			}
		</style>
	</head>
	<body>
		<div class="container">
			<h1>Lista de Tarefas</h1>

			<div>
				<label for="tarefa">Tarefa:</label>
				<div class="input-container">
					<input
						type="text"
						id="tarefa"
						placeholder="Digite uma nova tarefa..." />
					<button
						class="btn"
						onclick="adicionarTarefa()">
						Adicionar
					</button>
				</div>
			</div>

			<div class="contador-tarefas">
				<span id="contador">0 tarefas</span>
			</div>

			<ul
				class="lista-tarefas"
				id="listaTarefas">
				<li
					class="lista-vazia"
					id="listaVazia">
					Nenhuma tarefa adicionada ainda. Adicione uma tarefa acima!
				</li>
			</ul>

			<h2>Tarefas Concluídas</h2>
			<div class="contador-tarefas">
				<span id="contadorConcluidas">0 tarefas concluídas</span>
			</div>

			<ul
				class="lista-tarefas"
				id="listaTarefasConcluidas">
				<li
					class="lista-vazia"
					id="listaConcluidasVazia">
					Nenhuma tarefa concluída ainda.
				</li>
			</ul>
		</div>

		<script>
			const inputTarefa = document.getElementById('tarefa');
			const listaTarefas = document.getElementById('listaTarefas');
			const listaTarefasConcluidas = document.getElementById(
				'listaTarefasConcluidas'
			);
			const listaVazia = document.getElementById('listaVazia');
			const listaConcluidasVazia = document.getElementById(
				'listaConcluidasVazia'
			);
			const contador = document.getElementById('contador');
			const contadorConcluidas =
				document.getElementById('contadorConcluidas');

			let tarefas = [];

			// Carregar tarefas do localStorage ao inicializar
			function carregarTarefas() {
				const tarefasSalvas = localStorage.getItem('listaTarefas');
				if (tarefasSalvas) {
					tarefas = JSON.parse(tarefasSalvas);
					// Migrar tarefas antigas (string) para novo formato (objeto)
					tarefas = tarefas.map((tarefa) => {
						if (typeof tarefa === 'string') {
							return {
								id: Date.now() + Math.random(), // ID único
								texto: tarefa,
								concluida: false
							};
						}
						return tarefa;
					});
					renderizarListas();
				}
			}

			// Salvar tarefas no localStorage
			function salvarTarefas() {
				localStorage.setItem('listaTarefas', JSON.stringify(tarefas));
			}

			function adicionarTarefa() {
				const textoTarefa = inputTarefa.value.trim();

				if (textoTarefa === '') {
					alert('Por favor, digite uma tarefa!');
					return;
				}

				// Adicionar tarefa ao array com status de não concluída
				const novaTarefa = {
					id: Date.now(), // ID único baseado no timestamp
					texto: textoTarefa,
					concluida: false
				};

				tarefas.push(novaTarefa);

				// Salvar no localStorage
				salvarTarefas();

				// Recriar toda a lista
				renderizarListas();

				// Limpar input
				inputTarefa.value = '';

				console.log('Tarefa adicionada:', textoTarefa);
				console.log('Total de tarefas:', tarefas.length);
			}

			function removerTarefa(id) {
				// Encontrar e remover tarefa pelo ID
				const index = tarefas.findIndex((tarefa) => tarefa.id === id);
				if (index !== -1) {
					const tarefaRemovida = tarefas.splice(index, 1)[0];
					console.log('Tarefa removida:', tarefaRemovida.texto);
				}

				// Salvar no localStorage
				salvarTarefas();

				// Recriar toda a lista
				renderizarListas();

				console.log('Total de tarefas:', tarefas.length);
			}

			function alternarStatusTarefa(id) {
				// Encontrar tarefa pelo ID e alterar status
				const tarefa = tarefas.find((t) => t.id === id);
				if (tarefa) {
					tarefa.concluida = !tarefa.concluida;
					console.log(
						`Tarefa "${tarefa.texto}" ${
							tarefa.concluida ? 'concluída' : 'desmarcada'
						}`
					);

					// Salvar no localStorage
					salvarTarefas();

					// Recriar listas
					renderizarListas();
				}
			}

			function renderizarListas() {
				renderizarTarefasPendentes();
				renderizarTarefasConcluidas();
				atualizarContadores();
			}

			function renderizarTarefasPendentes() {
				// Limpar lista de tarefas pendentes
				listaTarefas.innerHTML = '';

				const tarefasPendentes = tarefas.filter((t) => !t.concluida);

				if (tarefasPendentes.length === 0) {
					// Mostrar mensagem de lista vazia
					listaTarefas.appendChild(listaVazia);
					listaVazia.style.display = 'block';
				} else {
					// Criar itens das tarefas pendentes
					tarefasPendentes.forEach((tarefa) => {
						const tarefaItem = document.createElement('li');
						tarefaItem.className = 'tarefa-item';

						tarefaItem.innerHTML = `
                        <div class="checkbox-container">
                            <input type="checkbox" 
                                   onchange="alternarStatusTarefa(${tarefa.id})"
                                   ${tarefa.concluida ? 'checked' : ''}>
                            <span class="tarefa-texto">${tarefa.texto}</span>
                        </div>
                        <button class="btn-remover" onclick="removerTarefa(${
							tarefa.id
						})">
                            Remover
                        </button>
                    `;

						listaTarefas.appendChild(tarefaItem);
					});
				}
			}

			function renderizarTarefasConcluidas() {
				// Limpar lista de tarefas concluídas
				listaTarefasConcluidas.innerHTML = '';

				const tarefasConcluidas = tarefas.filter((t) => t.concluida);

				if (tarefasConcluidas.length === 0) {
					// Mostrar mensagem de lista vazia
					listaTarefasConcluidas.appendChild(listaConcluidasVazia);
					listaConcluidasVazia.style.display = 'block';
				} else {
					// Criar itens das tarefas concluídas
					tarefasConcluidas.forEach((tarefa) => {
						const tarefaItem = document.createElement('li');
						tarefaItem.className = 'tarefa-item';

						tarefaItem.innerHTML = `
                        <div class="checkbox-container">
                            <input type="checkbox" 
                                   onchange="alternarStatusTarefa(${tarefa.id})"
                                   checked>
                            <span class="tarefa-texto tarefa-concluida">${tarefa.texto}</span>
                        </div>
                        <button class="btn-remover" onclick="removerTarefa(${tarefa.id})">
                            Remover
                        </button>
                    `;

						listaTarefasConcluidas.appendChild(tarefaItem);
					});
				}
			}

			function atualizarContadores() {
				const tarefasPendentes = tarefas.filter((t) => !t.concluida);
				const tarefasConcluidas = tarefas.filter((t) => t.concluida);

				const totalPendentes = tarefasPendentes.length;
				const totalConcluidas = tarefasConcluidas.length;

				contador.textContent = `${totalPendentes} ${
					totalPendentes === 1 ? 'tarefa' : 'tarefas'
				}`;

				contadorConcluidas.textContent = `${totalConcluidas} ${
					totalConcluidas === 1
						? 'tarefa concluída'
						: 'tarefas concluídas'
				}`;
			}

			// Permitir adicionar tarefa pressionando Enter
			inputTarefa.addEventListener('keypress', function (e) {
				if (e.key === 'Enter') {
					adicionarTarefa();
				}
			});

			// Carregar tarefas ao inicializar a página
			carregarTarefas();

			console.log('Lista de tarefas inicializada');
		</script>
	</body>
</html>
